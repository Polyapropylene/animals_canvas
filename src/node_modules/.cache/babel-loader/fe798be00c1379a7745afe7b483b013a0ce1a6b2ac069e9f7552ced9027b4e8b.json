{"ast":null,"code":"import { c as createNanoEvents, _ as __spreadArrays, a as __rest, b as __assign, p as proto } from './typings-56926c74.js';\nexport { M as MessageNames, V as VpsVersion } from './typings-56926c74.js';\n\n// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n// find the complete implementation of crypto (msCrypto) on IE11.\nvar getRandomValues = typeof crypto != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto != 'undefined' && typeof msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto);\nvar rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\nfunction rng() {\n  if (!getRandomValues) {\n    throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n  }\n  return getRandomValues(rnds8);\n}\n\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex; // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n\n  return [bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]]].join('');\n}\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n  if (typeof options == 'string') {\n    buf = options === 'binary' ? new Array(16) : null;\n    options = null;\n  }\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n  return buf || bytesToUuid(rnds);\n}\nvar createNanoObservable = function (observerFunc) {\n  var _a = createNanoEvents(),\n    on = _a.on,\n    emit = _a.emit;\n  var subscribe = function (_a) {\n    var next = _a.next;\n    var unsubscribe = on('next', next);\n    return {\n      unsubscribe: unsubscribe\n    };\n  };\n  observerFunc({\n    next: function (data) {\n      emit('next', data);\n    }\n  });\n  return {\n    subscribe: subscribe\n  };\n};\nvar isDeepEqual = function (a, b) {\n  // Простое значение\n  if (typeof a !== 'object' || a === null) {\n    return a === b;\n  }\n  // Массив\n  if (Array.isArray(a)) {\n    if (!Array.isArray(b) || a.length !== b.length) {\n      return false;\n    }\n    return !a.some(function (valA, key) {\n      return !isDeepEqual(valA, b[key]);\n    });\n  }\n  // Словарь\n  if (typeof b !== 'object' || b === null) {\n    return false;\n  }\n  var entriesA = Object.entries(a);\n  var entriesB = Object.entries(b);\n  if (entriesA.length !== entriesB.length) {\n    return false;\n  }\n  return !entriesA.some(function (_a) {\n    var key = _a[0],\n      valA = _a[1];\n    return !(key in b && isDeepEqual(valA, b[key]));\n  });\n};\nvar findCommandIndex = function (arr, command) {\n  var insets = ['insets', 'minimum_static_insets', 'maximum_static_insets', 'dynamic_insets'];\n  var index = -1;\n  if (command.type === 'character') {\n    index = arr.findIndex(function (c) {\n      return c.type === 'character' && c.character.id === command.character.id;\n    });\n  } else if (insets.includes(command.type)) {\n    index = arr.findIndex(function (c) {\n      return c.type === command.type;\n    });\n  } else if (command.type === 'app_context') {\n    index = arr.findIndex(function (c) {\n      return c.type === 'app_context';\n    });\n  } else {\n    index = arr.findIndex(function (c) {\n      return isDeepEqual(c, command);\n    });\n  }\n  return index;\n};\nvar appInitialData = function () {\n  var isPulled = false;\n  var pulled = [];\n  var committed = [];\n  var diff = [];\n  var isCommandWasPulled = function (command) {\n    return findCommandIndex(pulled, command) >= 0;\n  };\n  return {\n    /**\n     * Прочитать appInitialData. Запоминает состояние на момент прочтения\n     * @returns Массив комманд\n     */\n    pull: function () {\n      isPulled = true;\n      pulled = __spreadArrays(window.appInitialData || []);\n      return __spreadArrays(pulled);\n    },\n    /**\n     * Прочитать appInitialData\n     * @returns Массив комманд\n     */\n    get: function () {\n      return __spreadArrays(window.appInitialData || []);\n    },\n    /**\n     * Зафиксировать текущее состояние appInitialData\n     */\n    commit: function () {\n      committed = __spreadArrays(window.appInitialData || []);\n      diff = isPulled === true ? (window.appInitialData || []).filter(function (c) {\n        return !isCommandWasPulled(c);\n      }) : __spreadArrays(window.appInitialData || []);\n    },\n    /**\n     * Возвращает диф appInitialData между pull и commit\n     * @returns Массив комманд\n     */\n    diff: function () {\n      return __spreadArrays(diff);\n    },\n    /**\n     * Возвращает флаг наличия command в appInitialData на момент commit\n     * @param command Команда, которую нужно проверить на наличие в appInitialData\n     * @returns true - если команда была в appInitialData\n     */\n    isCommitted: function (command) {\n      var commandIndex = findCommandIndex(committed, command);\n      var isCommitted = commandIndex >= 0;\n      if (isCommitted) {\n        committed.splice(commandIndex, 1);\n      }\n      return isCommitted;\n    },\n    /**\n     * Возвращает первое сообщение из appInitialData, подходящее под фильтры param\n     * @param param Параметры: тип сообщения (например, smart_app_data)\n     * и тип команды (значение поля smart_app_data.type)\n     * @returns Первое сообщение, соответствующее параметрам или undefined\n     */\n    find: function (_a) {\n      var type = _a.type,\n        command = _a.command;\n      var initialCommands = __spreadArrays(window.appInitialData || []);\n      var result = initialCommands.find(function (initialCommand) {\n        if (!command && type && type === initialCommand.type) {\n          return true;\n        }\n        var isCommandInSmartAppData = command && 'smart_app_data' in initialCommand;\n        if (!isCommandInSmartAppData) {\n          return;\n        }\n        if (command === initialCommand.smart_app_data.command || command === initialCommand.smart_app_data.type) {\n          return true;\n        }\n        return false;\n      });\n      return result && 'smart_app_data' in result ? result.smart_app_data : result;\n    }\n  };\n}();\nvar excludeTags = ['A', 'AUDIO', 'BUTTON', 'INPUT', 'OPTION', 'SELECT', 'TEXTAREA', 'VIDEO'];\nfunction inIframe() {\n  try {\n    return window.self !== window.top;\n  } catch (e) {\n    return true;\n  }\n}\nif (typeof window !== 'undefined' && inIframe()) {\n  var postMessage_1 = function (action) {\n    var _a;\n    (_a = window.top) === null || _a === void 0 ? void 0 : _a.postMessage(JSON.stringify(action), '*');\n  };\n  var historyBack_1 = function () {\n    var prevPage = window.location.href;\n    window.history.back();\n    setTimeout(function () {\n      // закрываем страницу, если переход назад не поменял урл\n      if (window.location.href === prevPage) {\n        postMessage_1({\n          type: 'close'\n        });\n      }\n    }, 500);\n  };\n  window.appInitialData = [];\n  window.AssistantHost = {\n    sendDataContainer: function (json) {\n      postMessage_1({\n        type: 'sendDataContainer',\n        payload: json\n      });\n    },\n    close: function () {\n      postMessage_1({\n        type: 'close'\n      });\n    },\n    sendData: function (json) {\n      postMessage_1({\n        type: 'sendData',\n        payload: json\n      });\n    },\n    setSuggests: function (suggests) {\n      postMessage_1({\n        type: 'setSuggests',\n        payload: suggests\n      });\n    },\n    setHints: function (hints) {\n      postMessage_1({\n        type: 'setHints',\n        payload: hints\n      });\n    },\n    ready: function () {\n      postMessage_1({\n        type: 'ready'\n      });\n    },\n    sendText: function (message) {\n      postMessage_1({\n        type: 'sendText',\n        payload: message\n      });\n    },\n    setHeaderButtons: function (headerButtons) {\n      postMessage_1({\n        type: 'setHeaderButtons',\n        payload: headerButtons\n      });\n    }\n  };\n  window.addEventListener('message', function (e) {\n    var _a, _b, _c, _d, _e, _f, _g, _h;\n    try {\n      if (typeof e.data === 'string') {\n        var data = JSON.parse(e.data);\n        switch (data.type) {\n          case 'onBack':\n            historyBack_1();\n            break;\n          case 'onData':\n            (_b = (_a = window.AssistantClient) === null || _a === void 0 ? void 0 : _a.onData) === null || _b === void 0 ? void 0 : _b.call(_a, data.payload);\n            break;\n          case 'onRequestState':\n            {\n              var state = (_d = (_c = window.AssistantClient) === null || _c === void 0 ? void 0 : _c.onRequestState) === null || _d === void 0 ? void 0 : _d.call(_c);\n              postMessage_1({\n                type: 'state',\n                payload: state,\n                requestId: data.requestId\n              });\n              break;\n            }\n          case 'onRequestRecoveryState':\n            {\n              var recoverystate = (_f = (_e = window.AssistantClient) === null || _e === void 0 ? void 0 : _e.onRequestRecoveryState) === null || _f === void 0 ? void 0 : _f.call(_e);\n              postMessage_1({\n                type: 'recoveryState',\n                payload: recoverystate\n              });\n              break;\n            }\n          case 'onStart':\n            (_h = (_g = window.AssistantClient) === null || _g === void 0 ? void 0 : _g.onStart) === null || _h === void 0 ? void 0 : _h.call(_g);\n            break;\n          default:\n            // eslint-disable-next-line no-console\n            console.error(e, 'Unknown parsed message');\n            break;\n        }\n      }\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.error(err, 'Unknown message');\n    }\n  });\n  window.addEventListener('keydown', function (_a) {\n    var _b, _c;\n    var code = _a.code;\n    switch (code) {\n      case 'Enter':\n        if (document.activeElement && !excludeTags.includes(document.activeElement.tagName)) {\n          (_c = (_b = document.activeElement).click) === null || _c === void 0 ? void 0 : _c.call(_b);\n        }\n        break;\n      case 'Escape':\n        historyBack_1();\n        break;\n    }\n  });\n}\nvar createAssistant = function (_a) {\n  var _b;\n  var getState = _a.getState,\n    getRecoveryState = _a.getRecoveryState,\n    _c = _a.ready,\n    ready = _c === void 0 ? true : _c;\n  var currentGetState = getState;\n  var currentGetRecoveryState = getRecoveryState;\n  var isInitialCommandsEmitted = false;\n  var _d = createNanoEvents(),\n    on = _d.on,\n    emit = _d.emit;\n  var observables = new Map();\n  var emitCommand = function (command) {\n    if (command.type === 'smart_app_data') {\n      emit('command', command.smart_app_data);\n    }\n    if (command.type === 'smart_app_error') {\n      emit('error', command.smart_app_error);\n    }\n    return emit('data', command);\n  };\n  var cancelTts = typeof ((_b = window.AssistantHost) === null || _b === void 0 ? void 0 : _b.cancelTts) !== 'undefined' ? function () {\n    var _a, _b;\n    (_b = (_a = window.AssistantHost).cancelTts) === null || _b === void 0 ? void 0 : _b.call(_a, '');\n  } : undefined;\n  var emitAppInitialData = function () {\n    if (!isInitialCommandsEmitted) {\n      appInitialData.diff().forEach(function (c) {\n        return emitCommand(c);\n      });\n      isInitialCommandsEmitted = true;\n    }\n  };\n  var saveFirstSmartAppDataMid = function (mid) {\n    // eslint-disable-next-line no-underscore-dangle\n    if (typeof window.__ASSISTANT_CLIENT__.firstSmartAppDataMid === 'undefined') {\n      // eslint-disable-next-line no-underscore-dangle\n      window.__ASSISTANT_CLIENT__.firstSmartAppDataMid = mid;\n    }\n  };\n  window.AssistantClient = {\n    onData: function (command) {\n      var _a, _b, _c, _d, _e;\n      if (appInitialData.isCommitted(command)) {\n        return;\n      }\n      if (command.type === 'smart_app_data' && (((_a = command.sdk_meta) === null || _a === void 0 ? void 0 : _a.mid) || '-1') !== '-1') {\n        saveFirstSmartAppDataMid((_b = command.sdk_meta) === null || _b === void 0 ? void 0 : _b.mid);\n      }\n      /// фильтр команды 'назад'\n      /// может приходить type='system', но в типах это не отражаем\n      // eslint-disable-next-line @typescript-eslint/ban-ts-ignore\n      // @ts-ignore\n      if (command.type === 'system' && ((_d = (_c = command.system) === null || _c === void 0 ? void 0 : _c.command) === null || _d === void 0 ? void 0 : _d.toUpperCase()) === 'BACK') {\n        return;\n      }\n      if (command.type === 'tts_state_update') {\n        emit('tts', {\n          state: command.state,\n          owner: command.owner\n        });\n      }\n      if ((command.type === 'smart_app_data' || command.type === 'smart_app_error') && ((_e = command.sdk_meta) === null || _e === void 0 ? void 0 : _e.requestId) && observables.has(command.sdk_meta.requestId)) {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        var _f = command.sdk_meta,\n          realReqId = _f.requestId,\n          meta = __rest(_f, [\"requestId\"]);\n        var _g = observables.get(command.sdk_meta.requestId) || {},\n          requestId = _g.requestId,\n          next = _g.next;\n        if (Object.keys(meta).length > 0 || requestId) {\n          // eslint-disable-next-line @typescript-eslint/camelcase\n          command.sdk_meta = __assign({}, meta);\n          if (requestId) {\n            // eslint-disable-next-line @typescript-eslint/camelcase\n            command.sdk_meta = {\n              requestId: requestId\n            };\n          }\n        }\n        if (next) {\n          next(command.type === 'smart_app_data' ? command : command);\n        }\n        return;\n      }\n      emitCommand(command);\n    },\n    onRequestState: function () {\n      return currentGetState();\n    },\n    onRequestRecoveryState: function () {\n      if (currentGetRecoveryState) {\n        return currentGetRecoveryState();\n      }\n      return undefined;\n    },\n    onStart: function () {\n      emit('start');\n      emitAppInitialData();\n    }\n  };\n  var readyFn = function () {\n    var _a, _b, _c;\n    var firstSmartAppDataMid = ((_b = (_a = appInitialData.get().find(function (c) {\n      var _a;\n      return c.type === 'smart_app_data' && (((_a = c.sdk_meta) === null || _a === void 0 ? void 0 : _a.mid) || '-1') !== '-1';\n    })) === null || _a === void 0 ? void 0 : _a.sdk_meta) === null || _b === void 0 ? void 0 : _b.mid) || '-1';\n    if (firstSmartAppDataMid !== '-1') {\n      saveFirstSmartAppDataMid(firstSmartAppDataMid);\n    }\n    appInitialData.commit();\n    (_c = window.AssistantHost) === null || _c === void 0 ? void 0 : _c.ready();\n  };\n  if (ready) {\n    setTimeout(readyFn); // таймаут для подписки на start\n  }\n\n  var sendData = function (_a, onData) {\n    var _b, _c, _d;\n    var action = _a.action,\n      name = _a.name,\n      requestId = _a.requestId;\n    if ((_b = window.AssistantHost) === null || _b === void 0 ? void 0 : _b.sendDataContainer) {\n      if (onData == null) {\n        (_c = window.AssistantHost) === null || _c === void 0 ? void 0 : _c.sendDataContainer( /* eslint-disable-next-line @typescript-eslint/camelcase */\n        JSON.stringify({\n          data: action,\n          message_name: name || '',\n          requestId: requestId\n        }));\n        return function () {};\n      }\n      if (requestId && observables.has(requestId)) {\n        throw new Error('requestId должен быть уникальным');\n      }\n      var realRequestId_1 = requestId || v4();\n      var subscribe = createNanoObservable(function (_a) {\n        var _b;\n        var next = _a.next;\n        (_b = window.AssistantHost) === null || _b === void 0 ? void 0 : _b.sendDataContainer( /* eslint-disable-next-line @typescript-eslint/camelcase */\n        JSON.stringify({\n          data: action,\n          message_name: name || '',\n          requestId: realRequestId_1\n        }));\n        observables.set(realRequestId_1, {\n          next: next,\n          requestId: requestId\n        });\n      }).subscribe;\n      var unsubscribe_1 = subscribe({\n        next: onData\n      }).unsubscribe;\n      return function () {\n        unsubscribe_1();\n        observables.delete(realRequestId_1);\n      };\n    }\n    if (onData != null) {\n      throw new Error('Не поддерживается в данной версии клиента');\n    }\n    (_d = window.AssistantHost) === null || _d === void 0 ? void 0 : _d.sendData(JSON.stringify(action), name || null);\n    return function () {};\n  };\n  return {\n    cancelTts: cancelTts,\n    close: function () {\n      var _a;\n      return (_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.close();\n    },\n    getInitialData: appInitialData.pull,\n    findInInitialData: appInitialData.find,\n    getRecoveryState: function () {\n      return window.appRecoveryState;\n    },\n    on: on,\n    sendAction: function (action, onData, onError, _a) {\n      var _b = _a === void 0 ? {} : _a,\n        name = _b.name,\n        requestId = _b.requestId;\n      return sendData({\n        action: action,\n        name: name,\n        requestId: requestId\n      }, function (data) {\n        if (data.type === 'smart_app_data' && onData) {\n          onData(data.smart_app_data);\n          return;\n        }\n        if (data.type === 'smart_app_error' && onError) {\n          onError(data.smart_app_error);\n          return;\n        }\n        emitCommand(data);\n      });\n    },\n    sendData: sendData,\n    setGetState: function (nextGetState) {\n      currentGetState = nextGetState;\n    },\n    setGetRecoveryState: function (nextGetRecoveryState) {\n      currentGetRecoveryState = nextGetRecoveryState;\n    },\n    setSuggests: function (suggestions) {\n      var _a;\n      (_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.setSuggests(JSON.stringify({\n        suggestions: {\n          buttons: suggestions\n        }\n      }));\n    },\n    setHints: function (hints) {\n      var _a;\n      (_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.setHints(JSON.stringify({\n        hints: hints\n      }));\n    },\n    sendText: function (message) {\n      var _a;\n      return (_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.sendText(message);\n    },\n    setHeaderButtons: function (headerButtons) {\n      var _a, _b;\n      if (!((_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.setHeaderButtons)) {\n        throw new Error('setHeaderButtons не поддерживается в данной версии клиента');\n      }\n      (_b = window.AssistantHost) === null || _b === void 0 ? void 0 : _b.setHeaderButtons(JSON.stringify(headerButtons));\n    },\n    ready: readyFn\n  };\n};\nif (typeof window !== 'undefined') {\n  // eslint-disable-next-line no-underscore-dangle\n  window.__ASSISTANT_CLIENT__ = {\n    version: '1.10.0'\n  };\n}\nvar Message = proto.Message;\nexport { Message, createAssistant };","map":{"version":3,"names":["c","createNanoEvents","_","__spreadArrays","a","__rest","b","__assign","p","proto","M","MessageNames","V","VpsVersion","getRandomValues","crypto","bind","msCrypto","rnds8","Uint8Array","rng","Error","byteToHex","i","toString","substr","bytesToUuid","buf","offset","bth","join","v4","options","Array","rnds","random","ii","createNanoObservable","observerFunc","_a","on","emit","subscribe","next","unsubscribe","data","isDeepEqual","isArray","length","some","valA","key","entriesA","Object","entries","entriesB","findCommandIndex","arr","command","insets","index","type","findIndex","character","id","includes","appInitialData","isPulled","pulled","committed","diff","isCommandWasPulled","pull","window","get","commit","filter","isCommitted","commandIndex","splice","find","initialCommands","result","initialCommand","isCommandInSmartAppData","smart_app_data","excludeTags","inIframe","self","top","e","postMessage_1","action","postMessage","JSON","stringify","historyBack_1","prevPage","location","href","history","back","setTimeout","AssistantHost","sendDataContainer","json","payload","close","sendData","setSuggests","suggests","setHints","hints","ready","sendText","message","setHeaderButtons","headerButtons","addEventListener","_b","_c","_d","_e","_f","_g","_h","parse","AssistantClient","onData","call","state","onRequestState","requestId","recoverystate","onRequestRecoveryState","onStart","console","error","err","code","document","activeElement","tagName","click","createAssistant","getState","getRecoveryState","currentGetState","currentGetRecoveryState","isInitialCommandsEmitted","observables","Map","emitCommand","smart_app_error","cancelTts","undefined","emitAppInitialData","forEach","saveFirstSmartAppDataMid","mid","__ASSISTANT_CLIENT__","firstSmartAppDataMid","sdk_meta","system","toUpperCase","owner","has","realReqId","meta","keys","readyFn","name","message_name","realRequestId_1","set","unsubscribe_1","delete","getInitialData","findInInitialData","appRecoveryState","sendAction","onError","setGetState","nextGetState","setGetRecoveryState","nextGetRecoveryState","suggestions","buttons","version","Message"],"sources":["C:/Users/20618801/Desktop/src/node_modules/@salutejs/client/esm/createAssistant.js"],"sourcesContent":["import { c as createNanoEvents, _ as __spreadArrays, a as __rest, b as __assign, p as proto } from './typings-56926c74.js';\nexport { M as MessageNames, V as VpsVersion } from './typings-56926c74.js';\n\n// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\n// getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n// find the complete implementation of crypto (msCrypto) on IE11.\nvar getRandomValues = typeof crypto != 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto != 'undefined' && typeof msCrypto.getRandomValues == 'function' && msCrypto.getRandomValues.bind(msCrypto);\nvar rnds8 = new Uint8Array(16); // eslint-disable-line no-undef\n\nfunction rng() {\n  if (!getRandomValues) {\n    throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n  }\n\n  return getRandomValues(rnds8);\n}\n\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex[i] = (i + 0x100).toString(16).substr(1);\n}\n\nfunction bytesToUuid(buf, offset) {\n  var i = offset || 0;\n  var bth = byteToHex; // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4\n\n  return [bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], '-', bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]], bth[buf[i++]]].join('');\n}\n\nfunction v4(options, buf, offset) {\n  var i = buf && offset || 0;\n\n  if (typeof options == 'string') {\n    buf = options === 'binary' ? new Array(16) : null;\n    options = null;\n  }\n\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    for (var ii = 0; ii < 16; ++ii) {\n      buf[i + ii] = rnds[ii];\n    }\n  }\n\n  return buf || bytesToUuid(rnds);\n}\n\nvar createNanoObservable = function (observerFunc) {\n    var _a = createNanoEvents(), on = _a.on, emit = _a.emit;\n    var subscribe = function (_a) {\n        var next = _a.next;\n        var unsubscribe = on('next', next);\n        return { unsubscribe: unsubscribe };\n    };\n    observerFunc({\n        next: function (data) {\n            emit('next', data);\n        },\n    });\n    return {\n        subscribe: subscribe,\n    };\n};\n\nvar isDeepEqual = function (a, b) {\n    // Простое значение\n    if (typeof a !== 'object' || a === null) {\n        return a === b;\n    }\n    // Массив\n    if (Array.isArray(a)) {\n        if (!Array.isArray(b) || a.length !== b.length) {\n            return false;\n        }\n        return !a.some(function (valA, key) { return !isDeepEqual(valA, b[key]); });\n    }\n    // Словарь\n    if (typeof b !== 'object' || b === null) {\n        return false;\n    }\n    var entriesA = Object.entries(a);\n    var entriesB = Object.entries(b);\n    if (entriesA.length !== entriesB.length) {\n        return false;\n    }\n    return !entriesA.some(function (_a) {\n        var key = _a[0], valA = _a[1];\n        return !(key in b && isDeepEqual(valA, b[key]));\n    });\n};\nvar findCommandIndex = function (arr, command) {\n    var insets = ['insets', 'minimum_static_insets', 'maximum_static_insets', 'dynamic_insets'];\n    var index = -1;\n    if (command.type === 'character') {\n        index = arr.findIndex(function (c) { return c.type === 'character' && c.character.id === command.character.id; });\n    }\n    else if (insets.includes(command.type)) {\n        index = arr.findIndex(function (c) { return c.type === command.type; });\n    }\n    else if (command.type === 'app_context') {\n        index = arr.findIndex(function (c) { return c.type === 'app_context'; });\n    }\n    else {\n        index = arr.findIndex(function (c) { return isDeepEqual(c, command); });\n    }\n    return index;\n};\nvar appInitialData = (function () {\n    var isPulled = false;\n    var pulled = [];\n    var committed = [];\n    var diff = [];\n    var isCommandWasPulled = function (command) { return findCommandIndex(pulled, command) >= 0; };\n    return {\n        /**\n         * Прочитать appInitialData. Запоминает состояние на момент прочтения\n         * @returns Массив комманд\n         */\n        pull: function () {\n            isPulled = true;\n            pulled = __spreadArrays((window.appInitialData || []));\n            return __spreadArrays(pulled);\n        },\n        /**\n         * Прочитать appInitialData\n         * @returns Массив комманд\n         */\n        get: function () { return __spreadArrays((window.appInitialData || [])); },\n        /**\n         * Зафиксировать текущее состояние appInitialData\n         */\n        commit: function () {\n            committed = __spreadArrays((window.appInitialData || []));\n            diff =\n                isPulled === true\n                    ? (window.appInitialData || []).filter(function (c) { return !isCommandWasPulled(c); })\n                    : __spreadArrays((window.appInitialData || []));\n        },\n        /**\n         * Возвращает диф appInitialData между pull и commit\n         * @returns Массив комманд\n         */\n        diff: function () {\n            return __spreadArrays(diff);\n        },\n        /**\n         * Возвращает флаг наличия command в appInitialData на момент commit\n         * @param command Команда, которую нужно проверить на наличие в appInitialData\n         * @returns true - если команда была в appInitialData\n         */\n        isCommitted: function (command) {\n            var commandIndex = findCommandIndex(committed, command);\n            var isCommitted = commandIndex >= 0;\n            if (isCommitted) {\n                committed.splice(commandIndex, 1);\n            }\n            return isCommitted;\n        },\n        /**\n         * Возвращает первое сообщение из appInitialData, подходящее под фильтры param\n         * @param param Параметры: тип сообщения (например, smart_app_data)\n         * и тип команды (значение поля smart_app_data.type)\n         * @returns Первое сообщение, соответствующее параметрам или undefined\n         */\n        find: function (_a) {\n            var type = _a.type, command = _a.command;\n            var initialCommands = __spreadArrays((window.appInitialData || []));\n            var result = initialCommands.find(function (initialCommand) {\n                if (!command && type && type === initialCommand.type) {\n                    return true;\n                }\n                var isCommandInSmartAppData = command && 'smart_app_data' in initialCommand;\n                if (!isCommandInSmartAppData) {\n                    return;\n                }\n                if (command === initialCommand.smart_app_data.command ||\n                    command === initialCommand.smart_app_data.type) {\n                    return true;\n                }\n                return false;\n            });\n            return (result && 'smart_app_data' in result ? result.smart_app_data : result);\n        },\n    };\n})();\n\nvar excludeTags = ['A', 'AUDIO', 'BUTTON', 'INPUT', 'OPTION', 'SELECT', 'TEXTAREA', 'VIDEO'];\nfunction inIframe() {\n    try {\n        return window.self !== window.top;\n    }\n    catch (e) {\n        return true;\n    }\n}\nif (typeof window !== 'undefined' && inIframe()) {\n    var postMessage_1 = function (action) {\n        var _a;\n        (_a = window.top) === null || _a === void 0 ? void 0 : _a.postMessage(JSON.stringify(action), '*');\n    };\n    var historyBack_1 = function () {\n        var prevPage = window.location.href;\n        window.history.back();\n        setTimeout(function () {\n            // закрываем страницу, если переход назад не поменял урл\n            if (window.location.href === prevPage) {\n                postMessage_1({ type: 'close' });\n            }\n        }, 500);\n    };\n    window.appInitialData = [];\n    window.AssistantHost = {\n        sendDataContainer: function (json) {\n            postMessage_1({ type: 'sendDataContainer', payload: json });\n        },\n        close: function () {\n            postMessage_1({ type: 'close' });\n        },\n        sendData: function (json) {\n            postMessage_1({ type: 'sendData', payload: json });\n        },\n        setSuggests: function (suggests) {\n            postMessage_1({ type: 'setSuggests', payload: suggests });\n        },\n        setHints: function (hints) {\n            postMessage_1({ type: 'setHints', payload: hints });\n        },\n        ready: function () {\n            postMessage_1({ type: 'ready' });\n        },\n        sendText: function (message) {\n            postMessage_1({ type: 'sendText', payload: message });\n        },\n        setHeaderButtons: function (headerButtons) {\n            postMessage_1({ type: 'setHeaderButtons', payload: headerButtons });\n        },\n    };\n    window.addEventListener('message', function (e) {\n        var _a, _b, _c, _d, _e, _f, _g, _h;\n        try {\n            if (typeof e.data === 'string') {\n                var data = JSON.parse(e.data);\n                switch (data.type) {\n                    case 'onBack':\n                        historyBack_1();\n                        break;\n                    case 'onData':\n                        (_b = (_a = window.AssistantClient) === null || _a === void 0 ? void 0 : _a.onData) === null || _b === void 0 ? void 0 : _b.call(_a, data.payload);\n                        break;\n                    case 'onRequestState': {\n                        var state = (_d = (_c = window.AssistantClient) === null || _c === void 0 ? void 0 : _c.onRequestState) === null || _d === void 0 ? void 0 : _d.call(_c);\n                        postMessage_1({ type: 'state', payload: state, requestId: data.requestId });\n                        break;\n                    }\n                    case 'onRequestRecoveryState': {\n                        var recoverystate = (_f = (_e = window.AssistantClient) === null || _e === void 0 ? void 0 : _e.onRequestRecoveryState) === null || _f === void 0 ? void 0 : _f.call(_e);\n                        postMessage_1({ type: 'recoveryState', payload: recoverystate });\n                        break;\n                    }\n                    case 'onStart':\n                        (_h = (_g = window.AssistantClient) === null || _g === void 0 ? void 0 : _g.onStart) === null || _h === void 0 ? void 0 : _h.call(_g);\n                        break;\n                    default:\n                        // eslint-disable-next-line no-console\n                        console.error(e, 'Unknown parsed message');\n                        break;\n                }\n            }\n        }\n        catch (err) {\n            // eslint-disable-next-line no-console\n            console.error(err, 'Unknown message');\n        }\n    });\n    window.addEventListener('keydown', function (_a) {\n        var _b, _c;\n        var code = _a.code;\n        switch (code) {\n            case 'Enter':\n                if (document.activeElement && !excludeTags.includes(document.activeElement.tagName)) {\n                    (_c = (_b = document.activeElement).click) === null || _c === void 0 ? void 0 : _c.call(_b);\n                }\n                break;\n            case 'Escape':\n                historyBack_1();\n                break;\n        }\n    });\n}\nvar createAssistant = function (_a) {\n    var _b;\n    var getState = _a.getState, getRecoveryState = _a.getRecoveryState, _c = _a.ready, ready = _c === void 0 ? true : _c;\n    var currentGetState = getState;\n    var currentGetRecoveryState = getRecoveryState;\n    var isInitialCommandsEmitted = false;\n    var _d = createNanoEvents(), on = _d.on, emit = _d.emit;\n    var observables = new Map();\n    var emitCommand = function (command) {\n        if (command.type === 'smart_app_data') {\n            emit('command', command.smart_app_data);\n        }\n        if (command.type === 'smart_app_error') {\n            emit('error', command.smart_app_error);\n        }\n        return emit('data', command);\n    };\n    var cancelTts = typeof ((_b = window.AssistantHost) === null || _b === void 0 ? void 0 : _b.cancelTts) !== 'undefined'\n        ? function () {\n            var _a, _b;\n            (_b = (_a = window.AssistantHost).cancelTts) === null || _b === void 0 ? void 0 : _b.call(_a, '');\n        }\n        : undefined;\n    var emitAppInitialData = function () {\n        if (!isInitialCommandsEmitted) {\n            appInitialData.diff().forEach(function (c) { return emitCommand(c); });\n            isInitialCommandsEmitted = true;\n        }\n    };\n    var saveFirstSmartAppDataMid = function (mid) {\n        // eslint-disable-next-line no-underscore-dangle\n        if (typeof window.__ASSISTANT_CLIENT__.firstSmartAppDataMid === 'undefined') {\n            // eslint-disable-next-line no-underscore-dangle\n            window.__ASSISTANT_CLIENT__.firstSmartAppDataMid = mid;\n        }\n    };\n    window.AssistantClient = {\n        onData: function (command) {\n            var _a, _b, _c, _d, _e;\n            if (appInitialData.isCommitted(command)) {\n                return;\n            }\n            if (command.type === 'smart_app_data' && (((_a = command.sdk_meta) === null || _a === void 0 ? void 0 : _a.mid) || '-1') !== '-1') {\n                saveFirstSmartAppDataMid((_b = command.sdk_meta) === null || _b === void 0 ? void 0 : _b.mid);\n            }\n            /// фильтр команды 'назад'\n            /// может приходить type='system', но в типах это не отражаем\n            // eslint-disable-next-line @typescript-eslint/ban-ts-ignore\n            // @ts-ignore\n            if (command.type === 'system' && ((_d = (_c = command.system) === null || _c === void 0 ? void 0 : _c.command) === null || _d === void 0 ? void 0 : _d.toUpperCase()) === 'BACK') {\n                return;\n            }\n            if (command.type === 'tts_state_update') {\n                emit('tts', {\n                    state: command.state,\n                    owner: command.owner,\n                });\n            }\n            if ((command.type === 'smart_app_data' || command.type === 'smart_app_error') && ((_e = command.sdk_meta) === null || _e === void 0 ? void 0 : _e.requestId) &&\n                observables.has(command.sdk_meta.requestId)) {\n                // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                var _f = command.sdk_meta, realReqId = _f.requestId, meta = __rest(_f, [\"requestId\"]);\n                var _g = observables.get(command.sdk_meta.requestId) || {}, requestId = _g.requestId, next = _g.next;\n                if (Object.keys(meta).length > 0 || requestId) {\n                    // eslint-disable-next-line @typescript-eslint/camelcase\n                    command.sdk_meta = __assign({}, meta);\n                    if (requestId) {\n                        // eslint-disable-next-line @typescript-eslint/camelcase\n                        command.sdk_meta = { requestId: requestId };\n                    }\n                }\n                if (next) {\n                    next(command.type === 'smart_app_data' ? command : command);\n                }\n                return;\n            }\n            emitCommand(command);\n        },\n        onRequestState: function () {\n            return currentGetState();\n        },\n        onRequestRecoveryState: function () {\n            if (currentGetRecoveryState) {\n                return currentGetRecoveryState();\n            }\n            return undefined;\n        },\n        onStart: function () {\n            emit('start');\n            emitAppInitialData();\n        },\n    };\n    var readyFn = function () {\n        var _a, _b, _c;\n        var firstSmartAppDataMid = ((_b = (_a = appInitialData.get().find(function (c) {\n            var _a;\n            return c.type === 'smart_app_data' && (((_a = c.sdk_meta) === null || _a === void 0 ? void 0 : _a.mid) || '-1') !== '-1';\n        })) === null || _a === void 0 ? void 0 : _a.sdk_meta) === null || _b === void 0 ? void 0 : _b.mid) || '-1';\n        if (firstSmartAppDataMid !== '-1') {\n            saveFirstSmartAppDataMid(firstSmartAppDataMid);\n        }\n        appInitialData.commit();\n        (_c = window.AssistantHost) === null || _c === void 0 ? void 0 : _c.ready();\n    };\n    if (ready) {\n        setTimeout(readyFn); // таймаут для подписки на start\n    }\n    var sendData = function (_a, onData) {\n        var _b, _c, _d;\n        var action = _a.action, name = _a.name, requestId = _a.requestId;\n        if ((_b = window.AssistantHost) === null || _b === void 0 ? void 0 : _b.sendDataContainer) {\n            if (onData == null) {\n                (_c = window.AssistantHost) === null || _c === void 0 ? void 0 : _c.sendDataContainer(\n                /* eslint-disable-next-line @typescript-eslint/camelcase */\n                JSON.stringify({ data: action, message_name: name || '', requestId: requestId }));\n                return function () { };\n            }\n            if (requestId && observables.has(requestId)) {\n                throw new Error('requestId должен быть уникальным');\n            }\n            var realRequestId_1 = requestId || v4();\n            var subscribe = createNanoObservable(function (_a) {\n                var _b;\n                var next = _a.next;\n                (_b = window.AssistantHost) === null || _b === void 0 ? void 0 : _b.sendDataContainer(\n                /* eslint-disable-next-line @typescript-eslint/camelcase */\n                JSON.stringify({ data: action, message_name: name || '', requestId: realRequestId_1 }));\n                observables.set(realRequestId_1, { next: next, requestId: requestId });\n            }).subscribe;\n            var unsubscribe_1 = subscribe({ next: onData }).unsubscribe;\n            return function () {\n                unsubscribe_1();\n                observables.delete(realRequestId_1);\n            };\n        }\n        if (onData != null) {\n            throw new Error('Не поддерживается в данной версии клиента');\n        }\n        (_d = window.AssistantHost) === null || _d === void 0 ? void 0 : _d.sendData(JSON.stringify(action), name || null);\n        return function () { };\n    };\n    return {\n        cancelTts: cancelTts,\n        close: function () { var _a; return (_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.close(); },\n        getInitialData: appInitialData.pull,\n        findInInitialData: appInitialData.find,\n        getRecoveryState: function () { return window.appRecoveryState; },\n        on: on,\n        sendAction: function (action, onData, onError, _a) {\n            var _b = _a === void 0 ? {} : _a, name = _b.name, requestId = _b.requestId;\n            return sendData({ action: action, name: name, requestId: requestId }, function (data) {\n                if (data.type === 'smart_app_data' && onData) {\n                    onData(data.smart_app_data);\n                    return;\n                }\n                if (data.type === 'smart_app_error' && onError) {\n                    onError(data.smart_app_error);\n                    return;\n                }\n                emitCommand(data);\n            });\n        },\n        sendData: sendData,\n        setGetState: function (nextGetState) {\n            currentGetState = nextGetState;\n        },\n        setGetRecoveryState: function (nextGetRecoveryState) {\n            currentGetRecoveryState = nextGetRecoveryState;\n        },\n        setSuggests: function (suggestions) {\n            var _a;\n            (_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.setSuggests(JSON.stringify({ suggestions: { buttons: suggestions } }));\n        },\n        setHints: function (hints) {\n            var _a;\n            (_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.setHints(JSON.stringify({ hints: hints }));\n        },\n        sendText: function (message) { var _a; return (_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.sendText(message); },\n        setHeaderButtons: function (headerButtons) {\n            var _a, _b;\n            if (!((_a = window.AssistantHost) === null || _a === void 0 ? void 0 : _a.setHeaderButtons)) {\n                throw new Error('setHeaderButtons не поддерживается в данной версии клиента');\n            }\n            (_b = window.AssistantHost) === null || _b === void 0 ? void 0 : _b.setHeaderButtons(JSON.stringify(headerButtons));\n        },\n        ready: readyFn,\n    };\n};\nif (typeof window !== 'undefined') {\n    // eslint-disable-next-line no-underscore-dangle\n    window.__ASSISTANT_CLIENT__ = { version: '1.10.0' };\n}\n\nvar Message = proto.Message;\nexport { Message, createAssistant };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}